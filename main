import requests
import json
import os

f = open ("Nexpose-tags.txt", "r") #Change with name of text file where your hostnames and tagnames are added
for line in f:
	fields = line.split(" ", 1)
	asset_name = fields[0]
	tag_name = fields[1]
	print("Adding" + " " + asset_name + " for " + tag_name) 
	response = requests.post(
	'https://<IP_Address>:<port>/api/3/tags/', #add in your nexpose consoles IP and port number (default port = 3780)
		verify = False, 
		auth = ('username', 'Password'), #replace with credentials to log into the application
		headers={
			'Authorization': '<Enter your hash>',
			'Content-type':'application/json'
		},
		data = json.dumps({
			"color": "default",
			"created": "2021-01-28T23:50:01.205Z",
			"links": [{
				"href": "https://<IP_Address>:<Port>/api/3/tags/",
				"rel": "self"
			}],
			"name": tag_name,
			"riskModifier": 1, 
			"searchCriteria": { 
				"filters": [{
					"field": "host-name",
					"operator": "contains", #Can change search criteria according to API docuemntation
					"value": asset_name
				}],
				"match": "all"
			},
			"type": "owner" #Types include location, owner, criticality and custom
		})
	)
	print(response.json())
f.close()
